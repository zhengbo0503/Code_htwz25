# Code for the preprint
 - N. J. Higham, F. Tisseur, M. Webb, and Z. Zhou,
   Computing accurate eigenvalues using a mixed-precision Jacobi algorithm,
   arXiv:2501.03742, June 2025.
   Available at https://arxiv.org/abs/2501.03742v3.

# Usage 

These codes has been tested in my own computer with the following specs: 
```text
OS: macOS 15.5 24F74 arm64 
CPU: Apple M3 Pro 
GPU: Apple M3 Pro 
Memory: 36864MiB 
MATLAB version: 24.2.0.2923080 (R2024b) Update 6
Julia version: 1.11.5
```

## Download 
You may download the code using
```shell
git clone --depth=1 https://github.com/zhengbo0503/Code_htwz25.git 
```
to your preferred directory. 
For the sake of simplicity, suppose you have download the code to your device 
at `~/Code_htwz25`. 

There are main directories inside, `MATLAB` and `Julia`, which corresponding to 
MATLAB codes and Julia codes, respectively. 

## MATLAB 
1. The `src` folder contains all the functions you need to run the tests in the `test` folder. 
    - `mp_pjacobi.m` in `src` folder contains our main algorithm, mixed-precision preconditioned Jacobi algorithm.  
2. To run the tests, you need to enter the `test` folder by `cd MATLAB/test`.
3. Each test file has a self-explained name, and a short introduction within the code. 
   - `test_offA.m`: Test for reduction of $\mathrm{off}$ quantity after applying the preconditioner. 
   - `test_varying_cnd.m`: Test for relative forward error when we varying $\kappa_2(A)$.
   - `test_varying_dim.m`: Test for relative forward error when we varying the size of $A$.
   - `test_special_matrix.m`: Test for relative forward error when applying our algorithm on some special matrices.  
   - `test_reduction.m`: Test for the reduction of the scaled condition number between $A$ and $\widetilde{A}$. 
   - `test_timing.m`: Plotting the figure for timing. It should run after the execution of `Code_htwz25/Julia/test.jl`, as it requires the data generated by it. 

## Julia 
Our package is avaliable at [`JacobiEigen.jl`](https://github.com/zhengbo0503/JacobiEigen.jl).
Although our package is registered (i.e. you can access it via `Pkg.add("JacobiEigen")` and `using JacobiEigen`), we put a copy of the package here (`~/Code_htwz25/Julia/JacobiEigen`) to ensure stability.

1. Enter your Julia terminal via typing `julia` in your terminal. 
2. You need `Pkg` package to control the packages. Load it via `using Pkg`. 
3. If you have previously installed our package `JacobiEigen.jl`, then you should remove it by 
   ```julia 
   # Remove the package if loaded before. 
   Pkg.rm("JacobiEigen");
   ```
4. Install the package come with this repository by
   ```julia
   # Add the package via an absolute path to the JacobiEigen directory.
   Pkg.develop(path="~/Code_htwz25/Julia/JacobiEigen")
   ```
   Now you have a working package `JacobiEigen`!
5. Now, go back to your terminal by using `exit()`, and enter the Julia directory `Julia`. Now, you can run the test by 
   ```shell
   julia "~/Code_htwz25/Julia/test.jl"
   ```
   Note:
    - To export the results correctly, you have to stay in `~/Code_htwz25/Julia` and type the above code.
    - In addition, it seems like you have to have two files in the `~/Code_htwz25/Julia/result` folder, named `timing_cnd.csv` and `timing_order.csv`, respectively. Otherwise, it will not export the result. We include these fils in the repository such that you don't need to create anything. 
6. To view the results, you need to use the MATLAB file `~/Code_htwz/MATLAB/test/test_timing.m`. 

